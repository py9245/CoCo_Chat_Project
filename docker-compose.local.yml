services:
  backend:
    env_file:
      - ./.env.local
    # 호스트에서 직접 호출할 수 있도록 8000 포트를 열어둔다.
    ports:
      - "8000:8000"
    # 원격 Postgres를 사용하므로 db 서비스 의존성을 제거한다.
    depends_on: []
    extra_hosts:
      - "host.docker.internal:host-gateway"  # SSH 포트포워딩 DB 접속용

  # 로컬 개발 시 nginx 없이도 프런트(dev server)와 직접 통신할 수 있도록 프로파일로 분리한다.
  nginx:
    profiles:
      - local-nginx

  # EC2 Postgres를 공유할 것이므로 로컬에서는 기본적으로 기동하지 않는다.
  db:
    profiles:
      - remote-db
